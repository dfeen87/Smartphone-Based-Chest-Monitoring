name: CI

on:
  push:
    branches: ["**"]
  pull_request:

jobs:
  core-build-and-test:
    name: Build and test core library
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Build core library
        run: |
          g++ -c core/respirosync_core.cpp \
            -std=c++17 \
            -O2 \
            -Wall \
            -Wextra \
            -Werror \
            -o /tmp/respirosync_core.o

      - name: Build and run tests
        run: |
          make test
